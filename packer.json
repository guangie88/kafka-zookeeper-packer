{
  "min_packer_version": "1.1.2",
  "variables": {
    "ami_base_name": "kafka-zookeeper",
    "aws_region": "ap-southeast-1",
    "scala_version": "2.12",
    "kafka_version": "1.1.0"
  },
  "builders": [
    {
      "name": "{{ user `ami_base_name` }}",
      "ami_name": "{{ user `ami_base_name` }}-{{ isotime | clean_ami_name }}",
      "ami_description": "Ubuntu 18.04 LTS with Kafka and Zookeeper",
      "instance_type": "t2.micro",
      "region": "{{ user `aws_region` }}",
      "type": "amazon-ebs",
      "source_ami": "ami-ca320bb6",
      "ssh_username": "ubuntu"
    }
  ],
  "provisioners": [
    {
      "type": "ansible",
      "pause_before": "10s",
      "playbook_file": "{{ template_dir }}/site.yml",
      "extra_arguments": [
        "-e",
        "ansible_python_interpreter=/usr/bin/python3",
        "-e",
        "aws_region={{ user `aws_region` }}",
        "-e",
        "scala_version={{ user `scala_version` }}",
        "-e",
        "kafka_version={{ user `kafka_version` }}"
      ]
    }
  ]
}
